{% extends "base.html" %}
{% block title %}Mis Consultas{% endblock %}
{% block content %}
<div class="container">
    <nav class="navbar">
        <div class="navbar-brand">üè• Sistema Cl√≠nico</div>
        <div class="navbar-user">
            <span>üë®‚Äç‚öïÔ∏è Dr(a). {{ user.nombres }} {{ user.apellidos }}</span>
            <a href="/logout" class="btn btn-secondary">Cerrar Sesi√≥n</a>
        </div>
    </nav>
    
    <div class="page-header">
        <div>
            <a href="/dashboard" style="color: #4fc3f7; text-decoration: none;">‚Üê Volver al Dashboard</a>
            <h2 style="margin-top: 10px;">Mis Consultas Realizadas</h2>
        </div>
        <a href="/medico/nuevo-encuentro" class="btn btn-success">+ Nuevo Encuentro</a>
    </div>
    
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Paciente</th>
                    <th>Tipo</th>
                    <th>Sede</th>
                    <th>Diagn√≥stico</th>
                    <th>FHIR ID</th>
                </tr>
            </thead>
            <tbody>
                {% for e in encuentros %}
                <tr>
                    <td>{{ e.fecha.strftime('%d/%m/%Y %H:%M') }}</td>
                    <td>{{ e.paciente.nombres }} {{ e.paciente.apellidos }}</td>
                    <td>{{ e.tipo.nombre if e.tipo else 'N/A' }}</td>
                    <td>{{ e.sede.nombre if e.sede else 'N/A' }}</td>
                    <td>{{ e.diagnostico[:50] + '...' if e.diagnostico and e.diagnostico|length > 50 else e.diagnostico or 'Sin diagn√≥stico' }}</td>
                    <td>{{ e.fhir_encounter_id or 'No sincronizado' }}</td>
                </tr>
                {% endfor %}
                {% if not encuentros %}
                <tr>
                    <td colspan="6" style="text-align: center; color: #b0bec5;">No hay consultas registradas</td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
